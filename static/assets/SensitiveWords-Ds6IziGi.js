import{a as T,_ as q,R as F}from"./usePaginatedResource-CT70F4ic.js";import{ac as w,q as P,y as g,B as j,j as s,D as t,X as r,G as v,ad as z,L as h,U as k,J as x,ae as G,H,Y as J,af as _}from"./index-eFRUYAX7.js";import{c as Q,d as X}from"./index-DZXexlSu.js";import{B as Y}from"./Col-BLc3TCIj.js";import{F as K,_ as Z}from"./index-BeJdP8-t.js";import{a as ee,I as ae}from"./index-1fK8aAIM.js";const oe=async({page:d,pageSize:l,search:u})=>{const i={limit:l,offset:(d-1)*l};u&&(i.search=u);const{data:o}=await w.get("sensitive-words",{params:i});if(!o||!Array.isArray(o.words))throw new Error((o==null?void 0:o.message)||"敏感词数据格式不正确");return{items:o.words,total:o.total??o.words.length}},ne=d=>w.post("sensitive-words",{word:d}),se=d=>w.delete(`sensitive-words/${d}`),te={class:"sensitive-word-container"},re={__name:"SensitiveWords",setup(d){const l=g(!1),u=g(!1),i=g(""),{items:o,loading:y,searchQuery:m,searchLoading:C,pagination:S,handleSearch:b,handleTableChange:B,refresh:f}=T(oe,{initialPageSize:10}),W=[{title:"敏感词",dataIndex:"word",key:"word",width:300},{title:"操作",key:"action",width:150,fixed:"right"}],$=()=>f(),A=()=>{i.value="",l.value=!0},E=async()=>{var p,e;if(!i.value){_.warning("请输入敏感词");return}u.value=!0;try{const{data:a}=await ne(i.value);if(a.success)_.success(`已添加敏感词 ${i.value}`),l.value=!1,await f();else throw new Error((a==null?void 0:a.message)||"添加失败")}catch(a){_.error(`添加敏感词失败: ${((e=(p=a.response)==null?void 0:p.data)==null?void 0:e.message)||a.message||"未知错误"}`)}finally{u.value=!1}},I=async p=>{var e,a;try{const{data:n}=await se(p.id);if(n.success)_.success(`已移除敏感词 ${p.word}`),await f();else throw new Error((n==null?void 0:n.message)||"移除失败")}catch(n){_.error(`移除敏感词失败: ${((a=(e=n.response)==null?void 0:e.data)==null?void 0:a.message)||n.message||"未知错误"}`)}};return(p,e)=>{const a=ee,n=Y,N=Q,O=G,R=q,U=ae,V=Z,D=K,L=X;return v(),j("div",te,[s(N,{style:{"margin-bottom":"16px"}},{default:t(()=>[s(a,{value:r(m),"onUpdate:value":e[0]||(e[0]=c=>z(m)?m.value=c:null),placeholder:"搜索敏感词",style:{width:"200px"},onSearch:r(b),loading:r(C)},null,8,["value","onSearch","loading"]),s(n,{onClick:$},{icon:t(()=>[s(r(F))]),_:1}),s(n,{type:"primary",onClick:A},{default:t(()=>e[3]||(e[3]=[h("添加")])),_:1})]),_:1}),s(R,{columns:W,"data-source":r(o),pagination:r(S),loading:r(y),"row-key":"id",onChange:r(B),scroll:{x:600,y:500}},{emptyText:t(()=>[r(y)?x("",!0):(v(),k(O,{key:0,description:"暂无数据"},{description:t(()=>[H("span",null,J(r(o).length===0?"当前没有敏感词":"没有匹配的数据"),1)]),_:1}))]),bodyCell:t(({column:c,record:M})=>[c.key==="action"?(v(),k(n,{key:0,size:"small",danger:"",onClick:ie=>I(M)},{default:t(()=>e[4]||(e[4]=[h("移除")])),_:2},1032,["onClick"])):x("",!0)]),_:1},8,["data-source","pagination","loading","onChange"]),s(L,{open:l.value,"onUpdate:open":e[2]||(e[2]=c=>l.value=c),title:"添加敏感词",onOk:E,"confirm-loading":u.value},{default:t(()=>[s(D,{"label-col":{span:4},"wrapper-col":{span:20}},{default:t(()=>[s(V,{label:"敏感词",required:""},{default:t(()=>[s(U,{value:i.value,"onUpdate:value":e[1]||(e[1]=c=>i.value=c),placeholder:"请输入敏感词"},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["open","confirm-loading"])])}}},me=P(re,[["__scopeId","data-v-281a6593"]]);export{me as default};
